---
import PageLayout from "@/layouts/PageLayout.astro";
import { getCollection } from "astro:content";
import { CATEGORY_LINKS, CATEGORY_OPTIONS } from "@/utils/categories";

const posts = await getCollection("blogs");
const summaries: Record<(typeof CATEGORY_OPTIONS)[number], string> = {
  "TECNOLOGIA": "Ferramentas, protocolos e sistemas que moldam nossa atenção coletiva.",
  "GEOPOLÍTICA": "Fluxos de poder, cadeias globais e as narrativas entre estados.",
  "XADREZ & HOBBIES": "Estratégia, ritmo e a mente tranquila necessária para fechar a partida (e além).",
  "ARTE & CULTURA": "Estéticas, referências e repertórios que nos puxam para fora do óbvio.",
  "MUSICALIDADE": "Ritmos, melodias e experimentos sonoros para expandir os ouvidos.",
  "OFF-TOPIC": "Reflexões soltas, bastidores e tudo que não cabe nas outras categorias.",
};

const categories = CATEGORY_LINKS.map(({ label, slug }) => ({
  label,
  slug,
  summary: summaries[label],
  count: posts.filter((post) => post.data.category === label).length,
}));
---

<PageLayout title="Categorias">
  <section class="flex flex-col space-y-3 md:space-y-4">
    <!-- rótulo alinhado à mesma régua dos cards -->
    <div class="mx-auto w-full md:max-w-[46rem] lg:max-w-[50rem] xl:max-w-[52rem]">
      <p class="text-[12px] font-semibold uppercase tracking-[0.16em] text-muted-text">CATEGORIAS</p>
    </div>

    <!-- grade alinhada à mesma régua dos cards -->
    <div class="mx-auto w-full md:max-w-[46rem] lg:max-w-[50rem] xl:max-w-[52rem]">
      <ul class="grid gap-6 md:grid-cols-2">
        {categories.map((category) => (
          <li>
            <a
              href={`/categories/${category.slug}`}
              class="flex h-full flex-col justify-between rounded border border-border-ink/70 bg-card-bg px-6 py-6 ui-transition hover:border-border-ink/90 hover:bg-surface-bg"
            >
              <div class="flex flex-col gap-2">
                <p class="text-[11px] font-semibold uppercase tracking-[0.16em] text-muted-text">
                  {category.count} {category.count === 1 ? "artigo" : "artigos"}
                </p>
                <h2 class="text-xl font-semibold text-primary-text">{category.label}</h2>
                <p class="text-sm text-secondary-text">{category.summary}</p>
              </div>
              <span class="mt-5 text-xs font-semibold uppercase tracking-[0.16em] text-secondary-text">
                Ver publicações
              </span>
            </a>
          </li>
        ))}
      </ul>
    </div>
  </section>
</PageLayout>
