---
import PageLayout from "@/layouts/PageLayout.astro";
import { getCollection } from "astro:content";
import { CATEGORY_LINKS, CATEGORY_OPTIONS } from "@/utils/categories";

const posts = await getCollection("blogs");
const summaries: Record<(typeof CATEGORY_OPTIONS)[number], string> = {
  Chess: "Strategy, tempo, and the quiet mind required to end a game well.",
  Geopolitics: "Supply lines, influence maps, and the narratives states publish.",
  Philosophy: "Meaning-making for those who annotate their own interior lives.",
  Technology: "Tools, protocols, and the systems shaping our collective attention.",
};

const categories = CATEGORY_LINKS.map(({ label, slug }) => ({
  label,
  slug,
  summary: summaries[label],
  count: posts.filter((post) => post.data.category === label).length,
}));
---

<PageLayout title="Categories">
  <section class="flex flex-col gap-12">
    <div class="flex flex-col gap-4">
      <p class="text-sm uppercase tracking-[0.3em] text-muted-text">The journal's sections</p>
      <h1 class="font-display text-4xl leading-tight text-primary-text sm:text-5xl">
        Four perspectives, one Lefthand voice.
      </h1>
      <p class="max-w-2xl text-lg text-secondary-text">
        Each category is a deliberate lens on strategy, existence, and the tools we rely on. Choose a path and you will find the same calm typography and considered pacing as the home grid.
      </p>
    </div>
    <ul class="grid gap-6 md:grid-cols-2">
      {categories.map((category) => (
        <li>
          <a
            href={`/categories/${category.slug}`}
            class="flex h-full flex-col justify-between rounded-xl border border-border-ink/70 bg-card-bg px-6 py-8 transition-transform duration-200 hover:-translate-y-1"
          >
            <div class="flex flex-col gap-3">
              <p class="text-xs font-semibold uppercase tracking-[0.3em] text-muted-text">{category.count} article{category.count === 1 ? "" : "s"}</p>
              <h2 class="font-display text-2xl text-primary-text">{category.label}</h2>
              <p class="text-sm text-secondary-text">{category.summary}</p>
            </div>
            <span class="mt-6 text-sm font-semibold uppercase tracking-[0.3em] text-secondary-text">View stories</span>
          </a>
        </li>
      ))}
    </ul>
  </section>
</PageLayout>
