---
import PageLayout from "@/layouts/PageLayout.astro";
import { getCollection } from "astro:content";
import { CATEGORY_LINKS, CATEGORY_OPTIONS } from "@/utils/categories";

const posts = await getCollection("blogs");

// Mantemos o mapa caso volte a usar no futuro, mas não renderizamos o summary.
const summaries: Record<(typeof CATEGORY_OPTIONS)[number], string> = {
  Tecnologia: "Ferramentas, protocolos e sistemas que moldam nossa atenção coletiva.",
  Geopolítica: "Linhas de suprimento, mapas de influência e as narrativas dos estados.",
  Xadrez: "Estratégia, ritmo e a mente tranquila necessária para fechar a partida.",
};

const categories = CATEGORY_LINKS.map(({ label, slug }) => ({
  label,
  slug,
  count: posts.filter((post) => post.data.category === label).length,
}));
---

<PageLayout title="Categories">
  <section class="flex flex-col space-y-3 md:space-y-4">
    <!-- rótulo alinhado à mesma régua dos cards -->
    <div class="mx-auto w-full md:max-w-[46rem] lg:max-w-[50rem] xl:max-w-[52rem]">
      <p class="text-[12px] font-semibold uppercase tracking-[0.16em] text-muted-text">CATEGORIES</p>
    </div>

    <!-- grade alinhada à mesma régua dos cards -->
    <div class="mx-auto w-full md:max-w-[46rem] lg:max-w-[50rem] xl:max-w-[52rem]">
      <ul class="grid gap-6 md:grid-cols-2">
        {categories.map((category) => (
          <li>
            <a
              href={`/categories/${category.slug}`}
              class="flex h-full flex-col gap-2 rounded border border-border-ink/70 bg-card-bg px-6 py-6 ui-transition hover:border-border-ink/90 hover:bg-surface-bg"
            >
              <p class="text-[11px] font-semibold uppercase tracking-[0.16em] text-muted-text">
                {category.count} article{category.count === 1 ? "" : "s"}
              </p>
              <h2 class="text-xl font-semibold text-primary-text">{category.label}</h2>
              {/* descrição removida */}
              {/* “View stories” removido */}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </section>
</PageLayout>
