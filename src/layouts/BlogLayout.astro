---
import type { CollectionEntry } from "astro:content";
import PageLayout from "./PageLayout.astro";
import ShareButton from "@/components/Utils/ShareButton.svelte";

const {
  title,
  description,
  pubDate,
  author,
  heroImage,
  heroImageAlt,
  category,
} = Astro.props.data as CollectionEntry<"blogs">["data"];

const formattedDate = pubDate.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});

const shareUrl = Astro.site
  ? new URL(Astro.url.pathname, Astro.site).toString()
  : Astro.url.href;
---

<PageLayout title={title} description={description}>
  <article class="w-full flex flex-col gap-6 md:gap-8 pt-0 pb-0">
    <header class="flex flex-col gap-2 md:gap-3">
      <p class="text-[12px] font-semibold uppercase tracking-[0.14em] text-muted-text">
        {category}
      </p>

      <h1 class="mt-0.5 text-3xl md:text-5xl font-bold leading-snug text-primary-text text-balance text-center">
        {title}
      </h1>
    </header>

    <!-- Espaço um pouco menor entre título e conteúdo (texto ou imagem) -->
    <section
      class="mt-1 md:mt-2 flex flex-col
             [&_.prose>:first-child]:mt-0
             [&_.prose>p:first-child]:mt-0
             [&_.prose>figure:first-child]:mt-0
             [&_.prose>img:first-child]:mt-0
             [&_.prose>:last-child]:mb-0"
    >
      <slot />
    </section>

    <footer aria-label="Post meta" class="mt-10 md:mt-12 mb-0 flex justify-end">
      <div class="flex flex-wrap items-center gap-x-1 gap-y-1 text-sm text-secondary-text">
        <span class="font-semibold text-primary-text">By {author}</span>
        <span class="mx-1" aria-hidden="true">•</span>
        <time datetime={pubDate.toISOString()}>{formattedDate}</time>
        <span class="-ml-1 sm:-ml-2">
          <ShareButton client:idle url={shareUrl} title={title} />
        </span>
      </div>
    </footer>
  </article>
</PageLayout>
